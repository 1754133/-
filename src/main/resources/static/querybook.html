<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Query</title>
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<div class="header">
    <h1>欢迎使用图书管理系统</h1>
</div>

<div class="navbar">
    <a href="index.html">返回主页</a>
    <a href="#" class="right">帮助</a>
    <a href="index.html" class="right">注销</a>
</div>
<body>
<ul>
    <li><a href="mainpage.html">读者系统主页</a></li>
    <li><a class="active" href="#">查询图书信息</a></li>
    <li><a href="myinfo.html">个人信息</a></li>
    <li><a href="myborrow.html">我的借阅</a></li>
</ul>

<div style="margin-left:15%;padding:1px 16px;height:1000px;"><br/>
    <center><h5>请输入图书关键词:</h5><br/>
    <input style="width:400px;height:40px" type="text" value="" id="keyword" /><br/><br/>
        <a class="button black" onclick="query()">查找</a>
    <br/><br/>
    <table id="booklist" border="1" hidden width=70%>
        <thead>
        <tr>
            <th>书名</th>
            <th>作者</th>
            <th>书架号</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody id="tbdata">

        </tbody>
    </table>
    </center>
</div>
<script type="text/javascript">

    function query() {
        var keyword=$("#keyword").val();
        console.log(keyword)
        $.ajax({
            type:"GET",
            url:"http://localhost:8080/books/keywords/" + keyword,
            dateType:"json",
            success:function (result) {
                createlist(result)
            }
        })
    }

    function createlist(data) {
        var str="";
        for(var i=0;i<data.length;i++){
            str += "<tr><td><center>"+data[i].name+"</center></td><td><center>"+data[i].author+"</center></td><td><center>"+data[i].shelfId+"</center></td><td width=16%><center>"+"<a class=\"button\" onclick=\"gotodetail("+data[i].bookId+")\">前往详情页</a>"+"</center></td></tr>";
            console.log(str)
        }
        $("#tbdata").html(str);
        $("#booklist").show();
    }
    function gotodetail(bookid) {
        document.cookie="bookId="+bookid
        window.open("bookinfo.html")
    }
</script>
</body>
</html>