<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>图书管理系统</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
</head>
<body>

<div class="header">
    <h1>图书管理系统</h1>
    <p>请登录使用。</p>
</div>

<div class="navbar">
    <a style="background-color: #dddddd;color: black" href="login.html">学生登录</a>
    <a href="#">管理员登录</a>
    <a href="register.html">学生注册</a>
    <a href="#" class="right">帮助</a>
</div>
<center>
<div class="row">
    <div class="side">
        <h2>学生登录</h2>
        <h5 style="text-align:left;padding-left:37%;">请输入邮箱:</h5>
        <input style="width:400px;height:40px" type="text" value="" id="email" /><br/>
        <h5 style="text-align:left;padding-left:37%;">请输入密码：</h5>
        <input style="width:400px;height:40px" type="password" id="password" /><br/><br/><br/>
        <a class="button black" onclick="login()">登录</a>
        <a class="button black" onclick="toregister()">注册</a>
        <br/><br/>
    </div>

</div></center>

<script type="text/javascript">
    function login(){
        var email = $("#email").val();
        var password = $("#password").val();
        $.ajax({
            type:"POST",
            url:"http://localhost:8080/users/login",
            data:{
                email:email,
                password:password
            },
            dataType:"json",
            success:function(result){
                console.log(result)
                if (result.status){
                    document.cookie="id=" + result.userId + ";path=/";
                    alert("登陆成功!");
                    window.open("mainpage.html","_self");
                }else {
                    alert("账号或密码错误，请重新输入!");
                    window.location.reload();
                }
            }
        });
    }

    function toregister(){
        window.open("register.html","_self");
    }

</script>
</body>
</html>